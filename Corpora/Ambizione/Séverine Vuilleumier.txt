 Lead Lay summary Within a metapopulation, environmental heterogeneity induces variations in habitat quality from population to population, leading to variations in factors such as population size, selection pressure gene flow and genetic drift. These effects are expected to affect the theoretical predictions of the dynamic of genes in a metapopulation. In this context, this research, we will extend the theoretical description of the dynamics of neutral and adaptive genes (time and probability of fixation) and relax assumptions in currently used models.