 Lead Lay summary The genetic diversity we see today is strongly influenced by the demographic history of a population. In a small population, for instance, most individuals are relatively closely related and differ thus very little in their genetic makeup. In contrast, most individuals in larger populations are related only very distantly, and hence the populations exhibits much more diversity. However, the demographic history is not the only process shaping the genetic diversity. Another strong force is selection, which may favor a specific gene and, as a consequence, even individuals of large population may all carry the exact same mutation. Unfortunately, distinguishing between the effects of demography and selection is mathematically very difficult, particularly if the demographic history of a population is complex. We thus aim at developing new ways to detect the effects of selection by making extensive use of numerical simulations. If successful, these new approaches will then allow us to estimate the relative role of selection in the evolution of several species, including the HCM virus, which is affecting more than 30% of all people worldwide. By identifying the mutations with which the HCM virus is capable of adapting to our immune system, and eventually evading it, we hope to make a significant step forward in the development of a vaccine or treatment against this virus.